local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
   Name = "Combat Initation Script (v2.1.2)",
   Icon = 0, -- Icon in Topbar. Can use Lucide Icons (string) or Roblox Image (number). 0 to use no icon (default).
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by Sirius",
   Theme = "Default", -- Check https://docs.sirius.menu/rayfield/configuration/themes

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false, -- Prevents Rayfield from warning when the script has a version mismatch with the interface

   ConfigurationSaving = {
      Enabled = false,
      FolderName = nil, -- Create a custom folder for your hub/game
      FileName = "Big Hub"
   },

   Discord = {
      Enabled = false, -- Prompt the user to join your Discord server if their executor supports it
      Invite = "noinvitelink", -- The Discord invite code, do not include discord.gg/. E.g. discord.gg/ ABCD would be ABCD
      RememberJoins = true -- Set this to false to make them join the discord every time they load it up
   },

   KeySystem = false, -- Set this to true to use our key system
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided", -- Use this to tell the user how to get a key
      FileName = "Key", -- It is recommended to use something unique as other scripts using Rayfield may overwrite your key file
      SaveKey = true, -- The user's key will be saved, but if you change the key, they will be unable to use your script
      GrabKeyFromSite = false, -- If this is true, set Key below to the RAW site you would like Rayfield to get the key from
      Key = {"Hello"} -- List of keys that will be accepted by the system, can be RAW file links (pastebin, github etc) or simple strings ("hello","key22")
   }
})

-- Function to modify tool attributes safely (check both Backpack and equipped tools)
local function modifyToolAttributes(toolName, attributes)
    local player = game.Players.LocalPlayer
    local tool = player.Backpack:FindFirstChild(toolName) or player.Character:FindFirstChild(toolName)

    if tool then
        for attribute, value in pairs(attributes) do
            tool:SetAttribute(attribute, value)
        end
        print(toolName .. " attributes have been set.")
    else
        print(toolName .. " not found in the Backpack or equipped.")
    end
end

local Tab = Window:CreateTab("Fun Stuffz", 0)

local autoSlingshot = false
local autoPaintGun  = false
local autoFreezeRay = false

-- cooldowns (tweak as you like)
local slingshotCD = 0.2
local paintCD     = 0.15
local freezeCD    = 0.2

-- helper: get character and important parts safely
local function getCharParts()
	local player = game.Players.LocalPlayer
	if not player then return end
	local character = player.Character or player.CharacterAdded:Wait()
	local hrp = character:FindFirstChild("HumanoidRootPart")
	local hum = character:FindFirstChildOfClass("Humanoid")
	-- fallbacks
	hrp = hrp or character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
	return character, hum, hrp
end

-- helper: attempt to find the "part" target used in your original code.
-- For now we use the player's rootpart (this mirrors many of your original calls).
local function getLocalTargetPart(hum, hrp)
	-- If you have a specific "part" variable in your script, replace this logic.
	return (hum and hum.RootPart) or hrp
end

-- helper: fire a remote named VerifyHit inside a tool instance
local function fireVerifyHit(tool, ...)
	if not tool then return false, "no tool" end
	local remote = tool:FindFirstChild("VerifyHit")
	if not remote then
		-- sometimes the remote might be inside a subfolder or named different; print children for debugging
		return false, "no VerifyHit remote"
	end
	local ok, err = pcall(function() remote:FireServer(...) end)
	return ok, err
end

-- debug printer to help you track why something fails
local function debugPrint(tag, ...)
	print("[AutoWeapons]["..tag.."]", ...)
end

-- generic auto-loop spawner helper (keeps each loop separate and safe)
local function spawnAutoLoop(getAction, flagChecker, cd)
	task.spawn(function()
		local last = 0
		while flagChecker() do
			local now = tick()
			if now - last >= cd then
				last = now
				local ok, info = pcall(getAction)
				if not ok then
					debugPrint("Error", info)
				else
					-- getAction can return (true, msg) meaning success, or (false, reason)
					if info == false then
						-- if getAction returns false then maybe it's not ready
						-- info might contain a string reason in a second return value
					end
				end
			end
			task.wait(0.03) -- small wait so we don't busy-loop
		end
		debugPrint("LoopStopped", "flag is false")
	end)
end

-- ===== Slingshot toggle + action =====
local SectionAuto = Tab:CreateSection("Auto Weapons")
Tab:CreateToggle({
	Name = "Auto Slingshot",
	Flag = "AutoSlingshot",
	CurrentValue = false,
	Callback = function(Value)
		autoSlingshot = Value
		if autoSlingshot then
			debugPrint("Slingshot", "Enabled")
			spawnAutoLoop(function()
				local character, hum, hrp = getCharParts()
				if not character then return false end
				local part = getLocalTargetPart(hum, hrp)
				local slingshot = character:FindFirstChild("Slingshot")
				if not slingshot then
					debugPrint("Slingshot", "tool not found")
					return false
				end
				local ok, err = fireVerifyHit(slingshot, hum, part.Position, hrp.Position, part)
				if not ok then
					debugPrint("Slingshot Fire", "failed:", err)
				else
					debugPrint("Slingshot Fire", "sent")
				end
				return true
			end, function() return autoSlingshot end, slingshotCD)
		else
			debugPrint("Slingshot", "Disabled")
		end
	end
})

-- ===== Paintball Gun toggle + action =====
Tab:CreateToggle({
	Name = "Auto Paintball Gun",
	Flag = "AutoPaintGun",
	CurrentValue = false,
	Callback = function(Value)
		autoPaintGun = Value
		if autoPaintGun then
			debugPrint("PaintGun", "Enabled")
			spawnAutoLoop(function()
				local character, hum, hrp = getCharParts()
				if not character then return false end
				local part = getLocalTargetPart(hum, hrp)
				local gun = character:FindFirstChild("Paintball Gun")
				if not gun then
					debugPrint("PaintGun", "tool not found")
					return false
				end
				-- Your original call used different param order; match that here.
				-- If the server expects (hum, HRP.Position, part.Position, part, meta) keep it like below.
				local ok, err = fireVerifyHit(gun, hum, hrp.Position, part.Position, part, { Color = BrickColor.new(21) })
				if not ok then
					debugPrint("PaintGun Fire", "failed:", err)
				else
					debugPrint("PaintGun Fire", "sent")
				end
				return true
			end, function() return autoPaintGun end, paintCD)
		else
			debugPrint("PaintGun", "Disabled")
		end
	end
})

-- ===== Freeze Ray toggle + action =====
Tab:CreateToggle({
	Name = "Auto Freeze Ray",
	Flag = "AutoFreezeRay",
	CurrentValue = false,
	Callback = function(Value)
		autoFreezeRay = Value
		if autoFreezeRay then
			debugPrint("FreezeRay", "Enabled")
			spawnAutoLoop(function()
				local character, hum, hrp = getCharParts()
				if not character then return false end
				local part = getLocalTargetPart(hum, hrp)
				local freeze = character:FindFirstChild("Freeze Ray")
				if not freeze then
					debugPrint("FreezeRay", "tool not found")
					return false
				end
				local ok, err = fireVerifyHit(freeze, hum, part.Position, hrp.Position, part)
				if not ok then
					debugPrint("FreezeRay Fire", "failed:", err)
				else
					debugPrint("FreezeRay Fire", "sent")
				end
				return true
			end, function() return autoFreezeRay end, freezeCD)
		else
			debugPrint("FreezeRay", "Disabled")
		end
	end
})

local Section1 = Tab:CreateSection("Sword")
Tab:CreateParagraph({Title = "Sword", Content = "Parry go BRRR"})

-- Button for Modded Sword
Tab:CreateButton({
	Name = "Modded Sword",
	Callback = function(Value)
		modifyToolAttributes("Sword", {
			LungeRate = 0,
			Swingrate = 0,
			OffhandSwingRate = 0
		})
	end
})

-- Button for Modded Firebrand
Tab:CreateButton({
	Name = "Modded Firebrand",
	Callback = function()
		modifyToolAttributes("Firebrand", {
			LungeRate = 0,
			Swingrate = 0,
			OffhandSwingRate = 0,
			Windup = 0
		})
	end
})

-- Button for Modded Katana
Tab:CreateButton({
	Name = "Modded Katana",
	Callback = function()
		modifyToolAttributes("Katana", {
		    LungeRate = 0,
		    Swingrate = 0,
		    OffhandSwingRate = 0
		})
	end
})

local Section2 = Tab:CreateSection("Slingshot")
Tab:CreateParagraph({Title = "Slingshot", Content = "Spammy!"})

-- Button for Modded Slingshot
Tab:CreateButton({
	Name = "Modded Slingshot",
	Callback = function()
		modifyToolAttributes("Slingshot", {
			Capacity = 10000,
			ChargeRate = 0,
			Firerate = 0,
			Spread = 0,
			ProjectileSpeed = 2250
		})
	end
})

-- Button for Modded Flamethrower
Tab:CreateButton({
	Name = "Modded Flamethrower",
	Callback = function()
		modifyToolAttributes("Flamethrower", {
		    Cooldown = 0
		})
	end
})

local Section3 = Tab:CreateSection("Paintball Gun")
Tab:CreateParagraph({Title = "Paintball Gun", Content = "Ah, yes! The good ol' ranged guns!"})

-- Button for Modded Paintball Gun
Tab:CreateButton({
	Name = "Modded Paintball Gun",
	Callback = function()
		modifyToolAttributes("Paintball Gun", {
		    Firerate = 0,
		    ProjectileSpeed = 2250
		})
	end
})

-- Button for Modded BB Gun
Tab:CreateButton({
	Name = "Modded BB Gun",
	Callback = function()
		modifyToolAttributes("BB Gun", {
		    Firerate = 0,
		    MinShots = 2,
		    MaxShots = math.huge -- Use `math.huge` for infinite value
		})
	end
})

-- Button for Modded Freeze Ray
Tab:CreateButton({
	Name = "Modded Freeze Ray (Always Charged)",
	Callback = function()
		modifyToolAttributes("Freeze Ray", {
		    Firerate = 0,
		    ProjectileSpeed = 2250,
		    ChargeTime = 0
		})
	end
})
Tab:CreateButton({
	Name = "Modded Freeze Ray (Hold to Charge)",
	Callback = function()
		modifyToolAttributes("Freeze Ray", {
		    Firerate = 0,
		    ProjectileSpeed = 2250,
		})
	end
})

local Section4 = Tab:CreateSection("Superball")
Tab:CreateParagraph({Title = "Superball", Content = "Bounce."})

-- Button for Modded Ninja Stars
Tab:CreateButton({
	Name = "Modded Ninja Stars",
	Callback = function(Value)
		modifyToolAttributes("Ninja Stars", {
		    ThrowRate = 0,
		    Capacity = 10000000,
		    ChargeRate = 0
		})
	end
})

-- Button for Modded Bazooka
Tab:CreateButton({
	Name = "Modded Bazooka",
	Default = false,
	Flag = "Bazooka",
	Callback = function()
		modifyToolAttributes("Bazooka", {
			ReloadTick = 0,
			Capacity = 100,
			PassiveReloadTick = 0
		})
	end
})

local Section5 = Tab:CreateSection("Timebomb")
Tab:CreateParagraph({Title = "Timebomb", Content = "Chat is this real?"})

-- Button for Modded Subspace Tripmine
Tab:CreateButton({
	Name = "Modded Subspace Tripmine",
	Default = false,
	Flag = "Subspace_Tripmine",
	Callback = function()
		modifyToolAttributes("Subspace Tripmine", {
		    Cooldown = 0
		})
	end
})

-- Button for Modded Explosive Pinata
Tab:CreateButton({
	Name = "Modded Explosive Pinata",
	Callback = function(Value)
		    modifyToolAttributes("Explosive Pinata", {
			    Cooldown = 0
		    })
	end
})

local Section6 = Tab:CreateSection("Trowel")
Tab:CreateParagraph({Title = "Trowel", Content = "Hey look guys! I'm a Builder Man!"})

-- Toggle for Frozen Wrench
Tab:CreateToggle({
	Name = "Frozen Wrench",
	Flag = "Wrench",
	Callback = function(Value)
		local tool = game.Players.LocalPlayer.Backpack:FindFirstChild("Wrench") or game.Players.LocalPlayer.Character:FindFirstChild("Wrench")
		if tool then
			tool:SetAttribute("TimeScale", Value and 0 or 1)
		else
			print("Wrench not found in the Backpack or equipped.")
		end
	end
})

-- Hats Tab
local Tab2 = Window:CreateTab("Hats", 0)

-- Button for Electric Punk
Tab2:CreateButton({
	Name = "Electric Punk (Lighting Chance)",
	Callback = function()
		local accessoryEffects = game.Players.LocalPlayer.Backpack.Parent:FindFirstChild("AccessoryEffects")
		if accessoryEffects then
			accessoryEffects:SetAttribute("Lightning_Chance", 100)
		else
			print("AccessoryEffects not found.")
		end
	end
})

Tab2:CreateButton({
	Name = "Fire Trooper (Fire Chance)",
	Callback = function()
		local accessoryEffects = game.Players.LocalPlayer.Backpack.Parent:FindFirstChild("AccessoryEffects")
		if accessoryEffects then
			accessoryEffects:SetAttribute("Fire_Chance", 100)
		else
			print("AccessoryEffects not found.")
		end
	end
})

Tab2:CreateInput({
	Name = "Melee Range (5 = +500%)",
	CurrentValue = "5",
	RemoveTextAfterFocusLost = false,
	PlaceholderText = "",
	Flag = "meleerangevalue",
	Callback = function(Value)
		Rayfield.Flags["meleerangevalue"] = { Value = Value }
	end	  
})

Tab2:CreateInput({
	Name = "Pogo Range (5 = +500%)",
	Default = "5",
	RemoveTextAfterFocusLost = false,
	PlaceholderText = "",
	Flag = "pogorangevalue",
	Callback = function(Value)
		Rayfield.Flags["pogorangevalue"] = { Value = Value }
	end	  
})

Tab2:CreateButton({
	Name = "Bandit/Stage Prop (Melee Range & Pogo Range)",
	Callback = function()
		local accessoryEffects = game.Players.LocalPlayer.Backpack.Parent:FindFirstChild("AccessoryEffects")
		if accessoryEffects then
			accessoryEffects:SetAttribute("Melee_Range", Rayfield.Flags["meleerangevalue"].Value)
			accessoryEffects:SetAttribute("Pogo_Range", Rayfield.Flags["pogorangevalue"].Value)
		else
			print("AccessoryEffects not found.")
		end
	end
})

-- Character Tab
local Tab3 = Window:CreateTab("Character")

-- Button for Infinite Dashes
Tab3:CreateButton({
	Name = "Infinite Dashes",
	Callback = function()
		local character = game.Players.LocalPlayer.Character
		if character then
			character:SetAttribute("DashRegenTime", 0.05)
			character:SetAttribute("DashRegenFury", 0.05)
		else
			print("Character not found.")
		end
	end
})

-- Utility Boost Textbox and Button
Tab3:CreateInput({
	Name = "Utility Boost Value",
	CurrentValue = "2",
	RemoveTextAfterFocusLost = false,
	PlaceholderText = "",
	Flag = "utilityboostvalue",
	Callback = function(Value)
		Rayfield.Flags["utilityboostvalue"] = { Value = Value }
	end
})

Tab3:CreateButton({
	Name = "Utility Boost",
	Callback = function()
		local character = game.Players.LocalPlayer.Character
		if character then
			character:SetAttribute("UtilityBoost", Rayfield.Flags["utilityboostvalue"].Value)
		else
			print("Character not found.")
		end
	end
})

-- Info Tab
local Tab4 = Window:CreateTab("Information", 0)
Tab4:CreateParagraph({Title = "v2.1.2", Content = "Updated for"})
Tab4:CreateParagraph({Title = "v1.4 ALPHA", Content = "Current version"})
Tab4:CreateParagraph({Title = "marik611277", Content = "Made by"})
Tab4:CreateParagraph({Title = "Synapse X Remake", Content = "Created firstly in"})
Tab4:CreateParagraph({Title = "Non-GUI script", Content = "Inspired by"})
Tab4:CreateParagraph({Title = "discord.gg/HmP63uHfWq", Content = "Synapse X Remake Discord"})
